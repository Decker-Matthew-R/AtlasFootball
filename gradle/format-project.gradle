tasks.register('formatProject') {
    group = 'formatting'
    description = 'ğŸ¨ Format and fix all code (frontend + backend)'

    doFirst {
        println("ğŸš€ Formatting entire project...")
    }

    dependsOn("spotlessApply")
    dependsOn("installFrontend")
    doLast {
        println("ğŸ”§ Backend formatting complete")
        println("ğŸ’… Starting frontend formatting...")

        exec {
            workingDir = project.file('frontend')
            if (System.getProperty('os.name').toLowerCase().contains('windows')) {
                commandLine 'cmd', '/c', 'yarn', 'format'
            } else {
                commandLine 'yarn', 'format'
            }
        }

        println("ğŸ” Auto-fixing frontend linting issues...")

        exec {
            workingDir = project.file('frontend')
            if (System.getProperty('os.name').toLowerCase().contains('windows')) {
                commandLine 'cmd', '/c', 'yarn', 'lint:fix'
            } else {
                commandLine 'yarn', 'lint:fix'
            }
        }

        println("âœ¨ Project formatting complete!")
        println("ğŸ¯ All code has been formatted and linted")
    }
}
